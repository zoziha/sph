# 程序结构

详见第 10 章第 351 页。

---
**`src/kernel`**
> src/kernel/kernel.f90:定义了生成光滑函数及其导数的函数

---
**`src/utils`**
> src/utils/param.f90:定义了选择光滑函数，计算域维度等的参数
> src/utils/utils.f90:定义了一个数字转字符串的函数

---
**`src/single_step`**
> src/single_step/vir_part.f90:生成虚拟粒子，以方便实现边界条件

> src/single_step/viscosity.f90:定义了真实粒子的物理粘度系数\mu(程序中叫做\eta)，同时赋以虚拟粒子零粘度。

> src/single_step/eos.f90:定义了气体的状态方程，用能量和密度计算压力；定义了适用于人工压缩性的人工状态方程

> src/single_step/internal_force.f90:计算动量方程和能量方程

> src/single_step/external_force.f90:计算真实粒子的重力加速度，计算边界粒子的边界力

> src/single_step/density.f90:计算密度和密度变化率

> src/single_step/art_visc.f90:计算了因人工粘度导致粒子受力改变，且导致粒子能量耗散。

> src/single_step/art_heat.f90:计算了人工粘度导致的人工热量。

> src/single_step/av_vel.f90:提供了平均速度的计算公式。

> src/single_step/hsml.f90:提供了三种计算光滑长度h的方法

---
**`src/single/nnps`**
> direct_find.f90:全配对搜索法+成对相互作用法的实现


---
**`src`**
> src/sph_kind.f90:定义了双精度浮点数

> src/single_step.f90:

> src/time_integration.f90:


---